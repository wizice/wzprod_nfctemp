<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>관리자 설정</title>

    <!-- External CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/nfc_top.css?ts=202507300715">
    <link rel="stylesheet" href="css/nfc_admin.css?ts=202507300715">


</head>
<body>
<!-- 정품 마크 -->
<div class="certification-mark" id="certificationMark">
    <img src="img/certification_mark.png">
</div>

<div class="container">
    <!-- Header -->
    <div class="header">
        <img  id="logo_img"  class="no-select-img" src="img/company_logo.png">
        <div class="subtitle">NFC 온도기록라벨</div>
        <!-- Admin Menu Button -->
        <button class="top-icon-btn home-btn" id="homeBtn" aria-label="홈">
            <img src="img/home.svg">
        </button>
        <!-- Admin Menu Button -->
        <button class="top-icon-btn admin-menu-btn" id="adminMenuBtn" aria-label="관리자 메뉴">
            <img src="img/manager_login.svg" >
        </button>
    </div>

    <!-- NFC Status -->
    <div class="status-card">
        <div class="status-icon" id="nfcStatusIcon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
            </svg>
        </div>
        <div class="status-info">
            <h3 id="statusTitle">NFC 대기중</h3>
            <p id="statusSubtitle">태그를 인식시켜주세요</p>
        </div>
    </div>

    <!-- Tag Info (Hidden until tag is detected) -->
    <div class="tag-info-card" id="tagInfoCard" style="display: none;">
        <h2>태그 정보</h2>
        <div class="info-row">
            <span class="info-label">태그 ID:</span>
            <span class="info-value" id="tagId">-</span>
        </div>
        <div class="info-row">
            <span class="info-label">현재 상태:</span>
            <span class="info-value loggingStatus" id="loggingStatus">-</span>
        </div>
        <div class="info-row">
            <span class="info-label">측정 횟수:</span>
            <span class="info-value" id="currentCount">-</span>
        </div>
        <div class="info-row">
            <span class="info-label">측정 간격:</span>
            <span class="info-value" id="currentInterval">-</span>
        </div>
        <div class="info-row">
            <span class="info-label">최저 온도:</span>
            <span class="info-value" id="currentSettingMinTemp">-</span>
        </div>
        <div class="info-row">
            <span class="info-label">최고 온도:</span>
            <span class="info-value" id="currentSettingMaxTemp">-</span>
        </div>
    </div>

    <div class="settings-form hide" id="settingsForm" >
        <!-- 설정 입력 섹션 -->
        <div class="settings-card">
            <div class="settings-header">
                <h5>온도기록 세팅</h5>
                <button class="btn-logout"  >
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                        <polyline points="16 17 21 12 16 7"></polyline>
                        <line x1="21" y1="12" x2="9" y2="12"></line>
                    </svg>
                    로그아웃
                </button>
            </div>

            <div class="settings-body">
                <!-- 온도 설정 입력 -->
                <div class="settings-row">
                    <div class="setting-item">
                        <label for="interval">측정 간격</label>
                        <select id="interval" class="form-input" onchange="updateExpectedEndTime()">
                            <option value="1">1분</option>
                            <option value="5">5분</option>
                            <option value="10">10분</option>
                            <option value="15">15분</option>
                            <option value="30" >30분</option>
                            <option value="60">60분</option>
                        </select>
                    </div>

                    <div class="setting-item">
                        <label for="settingMinTemp">최저 온도</label>
                        <div class="input-with-unit">
                            <select id="settingMinTemp" class="form-input">
                                <option value="">선택하세요</option>
                                <option value="-30">-30°C</option>
                                <option value="-20">-20°C</option>
                                <option value="-18">-18°C</option>
                                <option value="-15">-15°C</option>
                                <option value="-10">-10°C</option>
                                <option value="-8">-8°C</option>
                                <option value="-5">-5°C</option>
                                <option value="-4">-4°C</option>
                                <option value="-3">-3°C</option>
                                <option value="-2">-2°C</option>
                                <option value="-1">-1°C</option>
                                <option value="0">0°C</option>
                                <option value="1">1°C</option>
                                <option value="2">2°C</option>
                                <option value="3">3°C</option>
                                <option value="4">4°C</option>
                                <option value="5">5°C</option>
                                <option value="8">8°C</option>
                                <option value="10">10°C</option>
                                <option value="15">15°C</option>
                                <option value="18">18°C</option>
                                <option value="20">20°C</option>
                                <option value="23">23°C</option>
                                <option value="25">25°C</option>
                                <option value="30">30°C</option>
                                <option value="35">35°C</option>
                                <option value="40">40°C</option>
                                <option value="50">50°C</option>
                            </select>
                            <span class="input-unit">°C</span>
                        </div>
                    </div>

                    <div class="setting-item">
                        <label for="settingMaxTemp">최고 온도</label>
                        <div class="input-with-unit">
                            <select id="settingMaxTemp" class="form-input">
                                <option value="">선택하세요</option>
                                <option value="-30">-30°C</option>
                                <option value="-20">-20°C</option>
                                <option value="-18">-18°C</option>
                                <option value="-15">-15°C</option>
                                <option value="-10">-10°C</option>
                                <option value="-8">-8°C</option>
                                <option value="-5">-5°C</option>
                                <option value="-4">-4°C</option>
                                <option value="-3">-3°C</option>
                                <option value="-2">-2°C</option>
                                <option value="-1">-1°C</option>
                                <option value="0">0°C</option>
                                <option value="1">1°C</option>
                                <option value="2">2°C</option>
                                <option value="3">3°C</option>
                                <option value="4">4°C</option>
                                <option value="5">5°C</option>
                                <option value="8">8°C</option>
                                <option value="10">10°C</option>
                                <option value="15">15°C</option>
                                <option value="18">18°C</option>
                                <option value="20">20°C</option>
                                <option value="23">23°C</option>
                                <option value="25">25°C</option>
                                <option value="30">30°C</option>
                                <option value="35">35°C</option>
                                <option value="40">40°C</option>
                                <option value="50">50°C</option>
                            </select>
                            <span class="input-unit">°C</span>
                        </div>
                    </div>

                </div>

                <!-- 예상 종료 시점 표시 -->
                <div class="info-section">
                    <div class="expected-end-time" id="expectedEndTime">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <polyline points="12 6 12 12 16 14"></polyline>
                        </svg>
                        <span>예상 종료시점: <strong id="endTimeText"> </strong></span>
                    </div>

                    <button class="btn-info" onclick="showIntervalInfo()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="16" x2="12" y2="12"></line>
                            <line x1="12" y1="8" x2="12.01" y2="8"></line>
                        </svg>
                        상세 안내
                    </button>
                </div>

                <!-- 온도기록 제어 버튼 -->
                <div class="control-section">
                    <button class="btn btn-start" onclick="startLogging()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="5 3 19 12 5 21 5 3"></polygon>
                        </svg>
                        온도기록 시작
                    </button>

                    <!-- 상태 표시 -->
                    <div class="status-display" id="div_loggingStatus">
                        <div class="status-item " id="statusReady"  >
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#6c757d" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M12 6v6l4 2"></path>
                            </svg>
                            <span>대기중</span>
                        </div>
                        <div class="status-item status-done " id="statusDone"  >
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#6c757d" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M12 6v6l4 2"></path>
                            </svg>
                            <span>측정완료</span>
                        </div>
                        <div class="status-item status-ok " id="statusOK"   >
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#28a745" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <polyline points="16 8 10 14 7 11"></polyline>
                            </svg>
                            <span>측정중</span>
                        </div>
                        <div class="status-item status-error " id="statusNG"  >
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#dc3545" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <line x1="15" y1="9" x2="9" y2="15"></line>
                                <line x1="9" y1="9" x2="15" y2="15"></line>
                            </svg>
                            <span>오류</span>
                        </div>
                    </div>

                    <div class="control-buttons">
                        <button class="btn btn-secondary" id="getLogging"  >
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="7 10 12 15 17 10"></polyline>
                                <line x1="12" y1="15" x2="12" y2="3"></line>
                            </svg>
                            온도기록 확인
                        </button>

                        <button class="btn btn-stop" onclick="stopLogging()">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="6" y="6" width="12" height="12"></rect>
                            </svg>
                            온도기록 중지
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- 측정간격 안내 모달 -->
    <div class="modal fade" id="intervalInfoModal" tabindex="-1" role="dialog" aria-labelledby="intervalInfoModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header bg-warning">
                    <h5 class="modal-title" id="intervalInfoModalLabel">측정간격에 따른 종료시점 안내</h5>
                    <button type="button" class="close"
                            onclick="$('#intervalInfoModal').modal('hide')"
                            data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <p class="text-center mb-3"><strong>10mAH 배터리 기준</strong></p>
                    <table class="table table-bordered table-hover">
                        <thead class="thead-light">
                        <tr>
                            <th class="text-center">Logging Interval</th>
                            <th class="text-center">측정간격</th>
                            <th class="text-center">종료시점</th>
                        </tr>
                        </thead>
                        <tbody id="intervalTableBody">
                            <tr data-interval="60">
                                <td class="text-center">60 sec</td>
                                <td class="text-center">1분</td>
                                <td class="text-center">약 2일 17시간</td>
                            </tr>
                            <tr data-interval="300">
                                <td class="text-center">300 sec</td>
                                <td class="text-center">5분</td>
                                <td class="text-center">약 13일 12시간</td>
                            </tr>
                            <tr data-interval="600">
                                <td class="text-center">600 sec</td>
                                <td class="text-center">10분</td>
                                <td class="text-center">약 27일</td>
                            </tr>
                            <tr data-interval="1200">
                                <td class="text-center">1200 sec</td>
                                <td class="text-center">20분</td>
                                <td class="text-center">약 54일</td>
                            </tr>
                            <tr data-interval="1800">
                                <td class="text-center">1800 sec</td>
                                <td class="text-center">30분</td>
                                <td class="text-center">약 81일 1시간</td>
                            </tr>
                            <tr data-interval="3600">
                                <td class="text-center">3600 sec</td>
                                <td class="text-center">60분</td>
                                <td class="text-center">약 161일 13시간</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="modal-footer">
                    <button type="button"
                            onclick="$('#intervalInfoModal').modal('hide')"
                            class="btn btn-secondary" data-dismiss="modal">닫기</button>
                </div>
            </div>
        </div>
    </div>

</div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<script src="js/jquery-3.6.0.min.js"></script>
<script src="js/bootstrap.bundle.min.js"></script>
<script src="js/manage_tag.js?ts=202507300715"></script>
<script src="js/nfc_common.js?ts=202507300715"></script>
<script src="js/nfc_admin.js?ts=202507300715"></script>
<script src="js/admin_session_check.js"></script>
</body>
</html>